---
import SiteLayout from "../../../../layouts/SiteLayout.astro";
import photos from "../../../../data/photos.json";

export async function getStaticPaths() {
  const unique = new Map();
  for (const p of photos) {
    unique.set(`${p.country}/${p.region}`, { country: p.country, region: p.region });
  }
  return Array.from(unique.values()).map(({ country, region }) => ({
    params: { country, region },
  }));
}

const { country, region } = Astro.params;
const items = photos.filter((p) => p.country === country && p.region === region);
const label = items[0]?.locationLabel ?? `${country}/${region}`;
---

<SiteLayout title={`${label} — Will’s Photos`}>
  <h1>{label}</h1>

  <div style="display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:14px;">
    {items.map((p) => (
      <a href={`/photo/${p.id}/`} style="text-decoration:none; color:inherit;">
        <div style="border-radius:14px; overflow:hidden; border:1px solid rgba(0,0,0,.08);">
          <img src={p.urls.thumb} alt={p.title} style="width:100%; height:170px; object-fit:cover; display:block;" />
          <div style="padding:12px;">
            <div style="font-weight:700;">{p.title}</div>
            <div style="opacity:.7; font-size:14px;">{p.date}</div>
          </div>
        </div>
      </a>
    ))}
  </div>
</SiteLayout>
